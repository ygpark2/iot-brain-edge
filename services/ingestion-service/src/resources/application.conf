# ============================
# Application
# ============================
app {
  name = "ingestion-service"
  env  = "dev"
}

# ============================
# Pekko (ActorSystem)
# ============================
pekko {
  loglevel = "INFO"
  stdout-loglevel = "INFO"

  actor {
    provider = "local"
  }

  http {
    server {
      preview.enable-http2 = on
    }
  }
}

# ============================
# Pekko Kafka
# ============================
pekko.kafka {
  consumer {
    kafka-clients {
      bootstrap.servers = "localhost:9094"
      group.id = "ingestion-service"

      auto.offset.reset = "earliest"
      enable.auto.commit = false

      key.deserializer   = "org.apache.kafka.common.serialization.StringDeserializer"
      value.deserializer = "org.apache.kafka.common.serialization.ByteArrayDeserializer"
    }
  }

  producer {
    kafka-clients {
      bootstrap.servers = "localhost:9094"

      key.serializer   = "org.apache.kafka.common.serialization.StringSerializer"
      value.serializer = "org.apache.kafka.common.serialization.ByteArraySerializer"

      acks = "all"
      retries = 3
    }
  }
}

# ============================
# Logging (HOCON side)
# ============================

# Pekko logging backend
pekko.loggers = ["org.apache.pekko.event.slf4j.Slf4jLogger"]
pekko.logging-filter = "org.apache.pekko.event.slf4j.Slf4jLoggingFilter"

# Reduce noise
pekko {
  log-dead-letters = 0
  log-dead-letters-during-shutdown = off
}

# ============================
# Kafka client logging noise control
# (logback.xml과 같이 쓰면 더 강력)
# ============================
org {
    apache {
        kafka {
            level = "WARN"
            clients {
                consumer {
                    internals {
                        level = "WARN"
                    }
                }
                producer {
                    internals {
                        level = "WARN"
                    }
                }
            }
        }
    }
}

kafka {
  client {
    log {
      level = "INFO"
    }
  }
}

# ============================
# Custom app config
# ============================
brain {
  kafka {
    topic = "rawframes"
    dlq-topic = "rawframes-dlq"
    parallelism = 8
  }

  shutdown {
    graceful-timeout = 10s
  }
}